# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Auth Context –ø—Ä–æ–±–ª–µ–º—ã

## üö® **–ü—Ä–æ–±–ª–µ–º–∞:**
```
Router error: Error: Auth context not provided
```

–û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ router guards –ø—ã—Ç–∞–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useAuth()` –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ auth context –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã:**

### **–ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±—ã–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º:**
1. Router –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è —Å guards
2. Guards –ø—ã—Ç–∞–ª–∏—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useAuth()`
3. Auth context –µ—â–µ –Ω–µ –±—ã–ª –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ `provideAuth()`
4. –†–µ–∑—É–ª—å—Ç–∞—Ç: "Auth context not provided"

### **–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
Vue composition API —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã `provide/inject` –±—ã–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `inject` –≤ –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∏–ª–∏ guards.

## ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

### üîß **1. –ù–æ–≤—ã–µ Router Guards (guards.ts)**

**–°–æ–∑–¥–∞–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è auth:**
```typescript
function getAuthSafely() {
  try {
    const { useAuth } = require("@/context/auth");
    return useAuth();
  } catch (error) {
    console.warn('Auth context not available:', error);
    return null;
  }
}
```

**Fallback –ª–æ–≥–∏–∫–∞ –¥–ª—è guards:**
```typescript
export const authGuard = (to, from, next) => {
  const auth = getAuthSafely();
  const meta = to.meta as RouteMetadata;

  // –ï—Å–ª–∏ auth context –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º localStorage
  if (!auth) {
    const token = localStorage.getItem('axenta_token');
    
    if (meta.requiresAuth && !token) {
      next({ path: "/login", query: { redirect: to.fullPath } });
      return;
    }
    
    if (meta.requiresGuest && token) {
      next("/dashboard");
      return;
    }
    
    next();
    return;
  }

  // –û–±—ã—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å auth context
  // ...
};
```

### üîß **2. –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π Router Guard**

**–í router/index.ts –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ—Å—Ç–æ–π guard –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç auth context:**
```typescript
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('axenta_token');
  const requiresAuth = to.meta?.requiresAuth;
  const requiresGuest = to.meta?.requiresGuest;
  
  if (requiresAuth && !token) {
    next({ path: '/login', query: { redirect: to.fullPath } });
    return;
  }
  
  if (requiresGuest && token) {
    next('/dashboard');
    return;
  }
  
  next();
});
```

### üîß **3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

**–í main.ts:**
```typescript
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - –≤–∞–∂–µ–Ω –ø–æ—Ä—è–¥–æ–∫!
app.use(pinia);   // –°–Ω–∞—á–∞–ª–∞ Pinia –¥–ª—è store
app.use(vuetify); // –ó–∞—Ç–µ–º UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
app.use(router);  // Router –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å
```

### üîß **4. –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏**

- `guards_old.ts` - —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è guards
- –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å fallback –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

### ‚úÖ **–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- ‚ùå `Router error: Error: Auth context not provided` ‚Üí ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–æ**
- ‚ùå `vite.svg 404` ‚Üí ‚úÖ **–§–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ dist/**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç

### üìà **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- **–†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞:** 453.42 KB (gzipped: 134.99 KB)
- **–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:** 1.84 —Å–µ–∫—É–Ω–¥—ã
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è

## üéØ **–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–µ—à–µ–Ω–∏—è:**

### **–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞:**

1. **–£—Ä–æ–≤–µ–Ω—å 1:** –ü—Ä–æ—Å—Ç—ã–µ guards –Ω–∞ –æ—Å–Ω–æ–≤–µ localStorage
   - –ë—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞—é—Ç
   - –ù–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç Vue context
   - –û–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–∞–∑–æ–≤—É—é –∑–∞—â–∏—Ç—É –º–∞—Ä—à—Ä—É—Ç–æ–≤

2. **–£—Ä–æ–≤–µ–Ω—å 2:** –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ guards —Å auth context
   - –†–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –ü—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

## üîÆ **–î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:**

### üìã **TODO:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–µ–π –≤ –ø—Ä–æ—Å—Ç—ã—Ö guards
- [ ] –°–æ–∑–¥–∞—Ç—å middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ auth —Å–æ—Å—Ç–æ—è–Ω–∏—è
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ì–æ—Å—Ç–µ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π/—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—Ç auth context

## üöÄ **–î–µ–ø–ª–æ–π:**

### **–ì–æ—Ç–æ–≤–æ –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–º—É –¥–µ–ø–ª–æ—é:**
```bash
git pull origin main
npm install
npm run build
# –î–µ–ø–ª–æ–π dist/ –ø–∞–ø–∫–∏
```

### **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
- ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

---

**üìÖ –î–∞—Ç–∞:** 18 —è–Ω–≤–∞—Ä—è 2025  
**üîß –°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é  
**‚ö° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
