# Система уведомлений для интеграции Axenta Cloud API

## Обзор

Реализована система уведомлений, которая автоматически проверяет статус интеграции с Axenta Cloud API и показывает уведомления в колокольчике, когда интеграция неактивна или требует настройки.

## Реализованные компоненты

### 1. Сервис проверки статуса (`settingsService.ts`)

Добавлен метод `checkAxentaIntegrationStatus()` для проверки статуса интеграции:

```typescript
async checkAxentaIntegrationStatus(): Promise<{ 
  isConfigured: boolean; 
  isActive: boolean; 
  needsPassword: boolean;
  lastSync?: Date;
  errorMessage?: string;
}>
```

### 2. Composable для уведомлений (`useAxentaIntegrationNotifications.ts`)

Создан composable для управления уведомлениями об интеграции Axenta:

- Автоматическая проверка статуса при загрузке приложения
- Периодическая проверка каждую минуту
- Показ уведомления при неактивной интеграции
- Переход к настройкам интеграции по клику на уведомление

### 3. Интеграция в AppLayout

Добавлена проверка статуса Axenta интеграции в главный компонент приложения:

- Импорт composable для уведомлений
- Вызов проверки при монтировании компонента
- Автоматическое отображение уведомлений

### 4. API endpoint для проверки статуса

Обновлен endpoint `/api/axenta/status` в бэкенде для возврата корректных данных:

```json
{
  "configured": true,
  "active": false,
  "last_sync": null,
  "errors_count": 0,
  "connection_ok": false,
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-15T10:00:00Z",
  "error_message": "Требуется настройка пароля"
}
```

## Логика работы

1. **При загрузке приложения** - автоматически проверяется статус Axenta интеграции
2. **Если интеграция неактивна** - показывается уведомление в колокольчике:
   - Заголовок: "Требуется настройка интеграции Axenta Cloud API"
   - Сообщение: "Необходимо ввести пароль для интеграции с Axenta Cloud. Данные в CRM не будут обновляться до настройки интеграции."
   - Кнопка "Настроить" для перехода к настройкам интеграции
3. **Периодическая проверка** - каждую минуту проверяется статус интеграции
4. **Уведомление исчезает** - когда интеграция становится активной

## Тестирование

Создана тестовая страница `test_axenta_notifications.html` для проверки работы системы:

- Проверка статуса Axenta интеграции
- Симуляция неактивной интеграции
- Логирование всех событий

## Использование

Система работает автоматически после интеграции в AppLayout. Никаких дополнительных действий не требуется.

Уведомления будут появляться в колокольчике в правом верхнем углу интерфейса, когда:

- Интеграция Axenta Cloud API не настроена
- Интеграция настроена, но неактивна
- Требуется ввод пароля для интеграции

## Файлы

- `src/composables/useAxentaIntegrationNotifications.ts` - Composable для уведомлений
- `src/services/settingsService.ts` - Метод проверки статуса
- `src/components/Layout/AppLayout.vue` - Интеграция в главный компонент
- `api/axenta_integration.go` - API endpoint для статуса
- `test_axenta_notifications.html` - Тестовая страница
