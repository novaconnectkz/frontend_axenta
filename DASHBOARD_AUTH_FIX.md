# üö® –≠–ö–°–¢–†–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: Dashboard Auth Context

## üîç **–ê–Ω–∞–ª–∏–∑ –Ω–æ–≤–æ–π –æ—à–∏–±–∫–∏:**

–ò–∑ –ª–æ–≥–∞ `axenta.glonass-saratov.ru-1755499612070.log`:

```
Router error: Error: Auth context not provided
at new Re (Dashboard-CAtL3P_s.js:1:995)  ‚Üê –ü–†–û–ë–õ–ï–ú–ê –í DASHBOARD
at Dashboard-CAtL3P_s.js:1:3389
```

### **–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
Dashboard.vue –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Options API —Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º –≤—ã–∑–æ–≤–æ–º `useAuth()` –≤ setup —Ñ—É–Ω–∫—Ü–∏–∏:

```typescript
export default defineComponent({
  setup() {
    const auth = useAuth(); // ‚ùå –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    // ...
  }
});
```

## ‚úÖ **–≠–ö–°–¢–†–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

### üîß **1. Dashboard.vue - –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è auth**

**–ë—ã–ª–æ:**
```typescript
setup() {
  const auth = useAuth(); // ‚ùå –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤—ã–∑–æ–≤
  
  return {
    auth, // ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å null –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
  };
}
```

**–°—Ç–∞–ª–æ:**
```typescript
setup() {
  // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è auth
  let auth: any = null;
  
  const getAuth = () => {
    if (!auth) {
      try {
        auth = useAuth();
      } catch (error) {
        console.warn('Auth context not available in Dashboard:', error);
        return null;
      }
    }
    return auth;
  };

  // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ auth –¥–ª—è template
  const authSafe = computed(() => getAuth());
  
  return {
    auth: authSafe, // ‚úÖ Computed —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
  };
}
```

### üîß **2. Template - –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**

**–û–±–Ω–æ–≤–ª–µ–Ω template –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å nullable auth:**
```vue
<h1 class="text-h4 font-weight-bold">
  –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ auth?.user?.value?.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å' }}!
</h1>
```

### üîß **3. handleLogout - Fallback –º–µ—Ö–∞–Ω–∏–∑–º**

**–î–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è logout:**
```typescript
const handleLogout = () => {
  const authContext = getAuth();
  if (authContext) {
    authContext.logout(); // ‚úÖ –û–±—ã—á–Ω—ã–π logout
  } else {
    // ‚úÖ Fallback - –æ—á–∏—â–∞–µ–º localStorage –Ω–∞–ø—Ä—è–º—É—é
    localStorage.removeItem('axenta_token');
    localStorage.removeItem('axenta_user');
    localStorage.removeItem('axenta_company');
  }
  router.push('/login');
};
```

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

### ‚úÖ **–°–±–æ—Ä–∫–∞:**
- **–†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞:** 453.36 KB (gzipped: 134.96 KB)
- **Dashboard –º–æ–¥—É–ª—å:** 59.58 KB (–¥–æ–±–∞–≤–ª–µ–Ω—ã safety checks)
- **–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏:** 1.90 —Å–µ–∫—É–Ω–¥—ã
- **–ú–æ–¥—É–ª–µ–π:** 669 (—Å—Ç–∞–±–∏–ª—å–Ω–æ)

### ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- Dashboard –±–æ–ª—å—à–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º auth context
- Graceful degradation –¥–ª—è –≤—Å–µ—Ö auth –∑–∞–≤–∏—Å–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã

## üéØ **–ü–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

### **–≠—Ç–∞–ø—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è auth context –æ—à–∏–±–æ–∫:**

1. ‚úÖ **Router Guards** - –¥–æ–±–∞–≤–ª–µ–Ω—ã fallback —á–µ—Ä–µ–∑ localStorage
2. ‚úÖ **WebSocket Service** - –ª–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è + –ø–æ–ª–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤  
3. ‚úÖ **AppleStyleLogin** - –ª–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è auth
4. ‚úÖ **Dashboard** - –ª–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è + –±–µ–∑–æ–ø–∞—Å–Ω—ã–π template
5. ‚úÖ **CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–ª—è refresh —Ç–æ–∫–µ–Ω–∞

### **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ auth context –æ—à–∏–±–æ–∫

## üöÄ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –î–ï–ü–õ–û–ô:**

### 1Ô∏è‚É£ **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
```bash
git pull origin main
npm install
npm run build
```

### 2Ô∏è‚É£ **–î–µ–ø–ª–æ–π:**
–ó–∞–º–µ–Ω–∏—Ç–µ `dist/` –ø–∞–ø–∫—É –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ

### 3Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–∫—Ä–æ–π—Ç–µ https://axenta.glonass-saratov.ru/login
- **–û–∂–∏–¥–∞–µ—Ç—Å—è:** –ü–û–õ–ù–û–°–¢–¨–Æ —á–∏—Å—Ç–∞—è –∫–æ–Ω—Å–æ–ª—å
- **–û–∂–∏–¥–∞–µ—Ç—Å—è:** –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **–û–∂–∏–¥–∞–µ—Ç—Å—è:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ Dashboard

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

### ‚ùå **–î–æ–ª–∂–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å—á–µ–∑–Ω—É—Ç—å:**
- `Router error: Error: Auth context not provided`
- `at new Re (Dashboard-*.js:1:995)`
- `–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: Error: Auth context not provided`
- –õ—é–±—ã–µ auth context –æ—à–∏–±–∫–∏

### ‚úÖ **–î–æ–ª–∂–Ω–æ –∏–¥–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –µ–¥–∏–Ω–æ–π –æ—à–∏–±–∫–∏
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ URL –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- Dashboard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Logout —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤—Å–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º

## ‚ö†Ô∏è **–í–∞–∂–Ω–æ:**

### **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:**
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+F5)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ü–û–õ–ù–û–°–¢–¨–Æ —á–∏—Å—Ç–æ–π
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Dashboard –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

### **–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:**
–ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å WebSocket —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

---

**üìÖ –î–∞—Ç–∞:** 18 —è–Ω–≤–∞—Ä—è 2025  
**üîß –°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ auth context –æ—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã  
**‚ö° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - –î–ï–ü–õ–û–ô –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù  
**üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
