# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –≤ –¥–æ–≥–æ–≤–æ—Ä–∞—Ö

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

–í —Ç–∞–±–ª–∏—Ü–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∫–æ–ª–æ–Ω–∫–∞ "–¢–∞—Ä–∏—Ñ" —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–∞—Ö, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ –¥–æ–≥–æ–≤–æ—Ä—É —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏.

## üéØ –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

### –ù–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞—Ä–∏—Ñ–æ–≤ (2+)
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è: üü° –ñ–µ–ª—Ç—ã–π —á–∏–ø —Å –∏–∫–æ–Ω–∫–æ–π: `‚ö° 2 —Ç–∞—Ä–∏—Ñ–∞` –∏–ª–∏ `‚ö° 3 —Ç–∞—Ä–∏—Ñ–∞`
- –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏: –¢—É–ª—Ç–∏–ø —Å–æ —Å–ø–∏—Å–∫–æ–º –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ –∏ –∏—Ö —Å—Ç–æ–∏–º–æ—Å—Ç—å—é
- –ü—Ä–∏–º–µ—Ä —Ç—É–ª—Ç–∏–ø–∞:
  ```
  –ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:
  1. –õ–∞–π—Ç (450,00 ‚ÇΩ/–º–µ—Å)
  2. –ì–æ–¥–æ–≤–æ–π (7200,00 ‚ÇΩ)
  ```

### –û–¥–∏–Ω —Ç–∞—Ä–∏—Ñ
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è: üîµ –°–∏–Ω–∏–π —á–∏–ø —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ç–∞—Ä–∏—Ñ–∞
- –ü–æ–¥ —á–∏–ø–æ–º: –¶–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `450,00 ‚ÇΩ/–º–µ—Å`)

### –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è: ‚ö™ –°–µ—Ä—ã–π —á–∏–ø —Å —Ç–∞—Ä–∏—Ñ–æ–º –∏–∑ –¥–æ–≥–æ–≤–æ—Ä–∞ (fallback)
- –ò–ª–∏: "–ù–µ —É–∫–∞–∑–∞–Ω"

## üìä –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
SELECT 
  c.id,
  c.number,
  COUNT(DISTINCT s.billing_plan_id) as unique_plans_count,
  STRING_AGG(DISTINCT bp.name, ', ') as plan_names
FROM tenant_186.contracts c
LEFT JOIN public.subscriptions s ON s.contract_id = c.id AND s.deleted_at IS NULL AND s.status IN ('active', 'scheduled')
LEFT JOIN public.billing_plans bp ON bp.id = s.billing_plan_id
WHERE c.admin_account_id = 186
GROUP BY c.id, c.number
HAVING COUNT(DISTINCT s.billing_plan_id) > 1;
```

### –¢–µ—Å—Ç–æ–≤—ã–π –¥–æ–≥–æ–≤–æ—Ä:

–í –±–∞–∑–µ –µ—Å—Ç—å –¥–æ–≥–æ–≤–æ—Ä **–¢-251125/016** (id=13) —Å –¥–≤—É–º—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏:
- "–õ–∞–π—Ç" (450‚ÇΩ/–º–µ—Å)
- "–ì–æ–¥–æ–≤–æ–π" (7200‚ÇΩ)

–û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∏ –Ω–∞–π–¥–∏—Ç–µ —ç—Ç–æ—Ç –¥–æ–≥–æ–≤–æ—Ä - –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∂–µ–ª—Ç—ã–π —á–∏–ø "2 —Ç–∞—Ä–∏—Ñ–∞" ‚ö°

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `frontend_axenta/src/views/Contracts.vue` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- Computed property: `contractTariffsMap` - –∫–∞—Ä—Ç–∞ —Ç–∞—Ä–∏—Ñ–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞
- –ú–µ—Ç–æ–¥: `loadSubscriptions()` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –¥–ª—è –≤—Å–µ—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤

### –õ–æ–≥–∏–∫–∞:
1. –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–≥–æ–≤–æ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã –∏–∑ –µ–≥–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
3. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–∞—Ä–∏—Ñ–æ–≤ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∏–ø –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

## üêõ –û—Ç–ª–∞–¥–∫–∞

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –±—É–¥—É—Ç –ª–æ–≥–∏:
```
üéØ Contracts with multiple plans: { 13: { count: 2, plans: ['–õ–∞–π—Ç', '–ì–æ–¥–æ–≤–æ–π'] } }
üéØ Contract 13 (–¢-251125/016) has 2 plans: ['–õ–∞–π—Ç', '–ì–æ–¥–æ–≤–æ–π']
```

–ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ –¥–æ–≥–æ–≤–æ—Ä—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã—à–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∏ –∏–º–µ—é—Ç —Å—Ç–∞—Ç—É—Å 'active' –∏–ª–∏ 'scheduled'

