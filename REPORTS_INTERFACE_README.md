# Интерфейс отчетности - Документация

## Обзор

Полнофункциональный интерфейс системы отчетности для Axenta CRM, позволяющий создавать, планировать и управлять отчетами по всем разделам системы.

## Реализованные компоненты

### 1. Основные файлы

#### `src/types/reports.ts`

- **Назначение**: Полная система типов TypeScript для отчетности
- **Основные интерфейсы**:
  - `Report` - основная модель отчета
  - `ReportTemplate` - шаблоны отчетов
  - `ReportSchedule` - расписания автоматических отчетов
  - `ReportExecution` - история выполнения
  - `ReportData` - структура данных отчета
  - `ReportParameters` - параметры фильтрации
- **Типы**: ReportType, ReportFormat, ReportStatus и др.

#### `src/services/reportsService.ts`

- **Назначение**: Сервис для работы с API отчетности с демо данными
- **Возможности**:
  - CRUD операции для отчетов, шаблонов, расписаний
  - Генерация предварительного просмотра
  - Конфигурация типов отчетов и форматов
  - Cron presets для расписаний
- **Демо данные**: 5 отчетов, 3 шаблона, 3 расписания, 3 выполнения

### 2. Главный интерфейс

#### `src/views/Reports.vue`

- **Назначение**: Основная страница системы отчетности
- **Структура**:
  - Статистические карточки (всего, сегодня, запланировано, ошибки)
  - Табы: Отчеты, Шаблоны, Расписание, История выполнения
  - Интеграция с конструктором отчетов
- **Маршрут**: `/reports`
- **Навигация**: Добавлена в AppLayout с иконкой `mdi-chart-line`

### 3. Компоненты отчетности

#### `src/components/Reports/ReportBuilder.vue`

- **Назначение**: Пошаговый конструктор создания отчетов
- **Этапы**:
  1. Выбор типа отчета (7 типов: объекты, пользователи, биллинг, монтажи, склад, договоры, общая статистика)
  2. Настройка параметров (период, фильтры, группировка)
  3. Выбор формата экспорта (CSV, Excel, PDF, JSON)
  4. Предварительный просмотр с генерацией демо данных
- **Валидация**: Проверка обязательных полей на каждом этапе
- **UX**: Современный stepper интерфейс с визуальными карточками

#### `src/components/Reports/ReportsTab.vue`

- **Назначение**: Управление созданными отчетами
- **Функции**:
  - Фильтрация по типу, статусу, поиск по названию
  - Таблица с информацией о статусе, размере, времени выполнения
  - Действия: скачивание, просмотр, удаление
- **Статусы**: Ожидает, Генерируется, Завершен, Ошибка, Отменен

#### `src/components/Reports/TemplatesTab.vue`

- **Назначение**: Управление шаблонами отчетов
- **Функции**:
  - Карточный вид шаблонов с иконками типов
  - Создание новых шаблонов
  - Запуск отчета по шаблону
  - Счетчик использований
- **Типы шаблонов**: Пользовательские и системные

#### `src/components/Reports/SchedulesTab.vue`

- **Назначение**: Автоматические отчеты по расписанию
- **Функции**:
  - Управление cron расписаниями
  - Настройка получателей email
  - Включение/отключение расписаний
  - Отображение следующего запуска
- **Presets**: Готовые шаблоны расписаний (ежедневно, еженедельно, ежемесячно)

#### `src/components/Reports/ExecutionsTab.vue`

- **Назначение**: История выполнения отчетов
- **Функции**:
  - Фильтрация по статусу и датам
  - Детальная информация о выполнении
  - Отслеживание отправки по email
  - Повтор неудачных выполнений
- **Статусы**: Запланирован, Выполняется, Завершен, Ошибка, Отменен

## Типы отчетов

### 1. Объекты мониторинга (`objects`)

- **Описание**: Отчеты по объектам, их статусам и активности
- **Параметры**: Локации, статусы, включение неактивных
- **Формат по умолчанию**: Excel
- **Поддержка графиков**: Да

### 2. Пользователи (`users`)

- **Описание**: Отчеты по пользователям и их активности
- **Параметры**: Пользователи, включение неактивных
- **Формат по умолчанию**: CSV
- **Поддержка графиков**: Да

### 3. Биллинг (`billing`)

- **Описание**: Финансовые отчеты, счета и платежи
- **Параметры**: Договоры, включение сводки
- **Формат по умолчанию**: PDF
- **Поддержка графиков**: Да

### 4. Монтажи (`installations`)

- **Описание**: Отчеты по выполненным монтажам и диагностикам
- **Параметры**: Монтажники, локации
- **Формат по умолчанию**: Excel
- **Поддержка графиков**: Да

### 5. Склад (`warehouse`)

- **Описание**: Отчеты по складским операциям и остаткам
- **Параметры**: Категории оборудования, локации
- **Формат по умолчанию**: Excel
- **Поддержка графиков**: Нет

### 6. Договоры (`contracts`)

- **Описание**: Отчеты по договорам и их исполнению
- **Параметры**: Договоры, статусы
- **Формат по умолчанию**: PDF
- **Поддержка графиков**: Да

### 7. Общая статистика (`general_stats`)

- **Описание**: Сводные отчеты по всем разделам системы
- **Параметры**: Графики, сводка
- **Формат по умолчанию**: PDF
- **Поддержка графиков**: Да

## Форматы экспорта

### CSV

- **Расширение**: .csv
- **MIME**: text/csv
- **Графики**: Не поддерживаются
- **Лимит**: 1,000,000 строк

### Excel (XLSX)

- **Расширение**: .xlsx
- **MIME**: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
- **Графики**: Поддерживаются
- **Лимит**: 1,000,000 строк

### PDF

- **Расширение**: .pdf
- **MIME**: application/pdf
- **Графики**: Поддерживаются
- **Лимит**: 50,000 строк

### JSON

- **Расширение**: .json
- **MIME**: application/json
- **Графики**: Не поддерживаются
- **Лимит**: 100,000 строк

## Демо данные

### Отчеты (5 шт.)

1. **Отчет по объектам мониторинга** - Excel, завершен, 2MB
2. **Биллинговый отчет** - PDF, завершен, 1MB
3. **Отчет по монтажам** - CSV, генерируется
4. **Складской отчет** - Excel, ошибка
5. **Отчет по пользователям** - JSON, завершен, 512KB

### Шаблоны (3 шт.)

1. **Ежемесячный отчет по объектам** - системный, 15 использований
2. **Биллинговый отчет по договорам** - системный, 8 использований
3. **Отчет эффективности монтажников** - пользовательский, 12 использований

### Расписания (3 шт.)

1. **Еженедельный отчет по объектам** - активен, понедельник 9:00
2. **Ежемесячный биллинговый отчет** - активен, 1 число 8:00
3. **Ежедневный отчет по монтажам** - отключен, ежедневно 18:00

### Выполнения (3 шт.)

1. **Еженедельный отчет** - завершен, 150с, отправлен 2 получателям
2. **Ежемесячный биллинг** - завершен, 225с, отправлен 2 получателям
3. **Ежедневный монтажи** - ошибка, недостаточно данных

## Особенности реализации

### Архитектура

- **Модульная структура**: Каждая вкладка - отдельный компонент
- **Композиция**: Главный компонент координирует работу вкладок
- **Типизация**: Полная типизация TypeScript
- **Реактивность**: Vue 3 Composition API

### UX/UI

- **Apple Design System**: Соответствие корпоративному стилю
- **Адаптивность**: Поддержка мобильных устройств
- **Загрузка**: Индикаторы состояния для всех операций
- **Валидация**: Проверка данных в реальном времени

### Интеграция

- **Маршрутизация**: Полная интеграция с Vue Router
- **Навигация**: Добавлена в основное меню
- **Авторизация**: Поддержка системы прав доступа
- **Мультитенантность**: Изоляция данных по компаниям

## Планы развития

### Ближайшие задачи

- [ ] Интеграция с реальным API
- [ ] Система прав доступа к отчетам
- [ ] Кэширование результатов
- [ ] Экспорт в дополнительные форматы

### Будущие улучшения

- [ ] Конструктор пользовательских отчетов
- [ ] Интерактивные дашборды
- [ ] Система подписок на отчеты
- [ ] API для внешних интеграций

## Тестирование

### Статус

- ✅ Типы TypeScript
- ✅ Демо данные
- ✅ Основные компоненты
- ✅ Навигация и маршрутизация
- ⏳ E2E тесты (планируется)
- ⏳ Unit тесты (планируется)

### Проверенная функциональность

- Создание отчетов через конструктор
- Управление шаблонами
- Настройка расписаний
- Просмотр истории выполнения
- Фильтрация и поиск
- Адаптивный дизайн

## Заключение

Интерфейс отчетности представляет собой полнофункциональную систему для создания, планирования и управления отчетами в Axenta CRM. Реализация включает современный пользовательский интерфейс, полную типизацию TypeScript, демо данные для тестирования и готова для интеграции с реальным backend API.

Система поддерживает 7 типов отчетов, 4 формата экспорта, автоматическое планирование и детальное отслеживание выполнения, что делает её готовой к использованию в продакшене.
