# Интерфейс управления складом

## Обзор

Интерфейс управления складом представляет собой полнофункциональную систему для работы с оборудованием, складскими операциями, уведомлениями и категориями. Интерфейс построен на Vue 3 + TypeScript + Vuetify с использованием современных практик разработки.

## Структура компонентов

### Основные компоненты

#### 1. Warehouse.vue - Главная страница склада
- **Местоположение**: `src/views/Warehouse.vue`
- **Описание**: Основная страница с вкладками для всех разделов склада
- **Функции**:
  - Отображение статистики склада в реальном времени
  - Навигация по вкладкам (Оборудование, Операции, Уведомления, Категории)
  - Быстрые действия (добавление оборудования, сканирование QR)

#### 2. EquipmentCatalog.vue - Каталог оборудования
- **Местоположение**: `src/components/Warehouse/EquipmentCatalog.vue`
- **Описание**: Полнофункциональный каталог оборудования
- **Функции**:
  - Поиск по серийному номеру, IMEI, модели, QR коду
  - Фильтрация по статусу, состоянию, категории, типу
  - Два режима отображения: сетка карточек и таблица
  - Сортировка по различным полям
  - Пагинация результатов
  - CRUD операции с оборудованием

#### 3. WarehouseOperations.vue - Складские операции
- **Местоположение**: `src/components/Warehouse/WarehouseOperations.vue`
- **Описание**: Отслеживание всех складских операций
- **Функции**:
  - Timeline отображение операций
  - Фильтрация по типу, статусу, датам
  - Создание новых операций
  - Детальная информация о каждой операции

#### 4. WarehouseAlerts.vue - Уведомления склада
- **Местоположение**: `src/components/Warehouse/WarehouseAlerts.vue`
- **Описание**: Система уведомлений о складских проблемах
- **Функции**:
  - Отображение уведомлений по важности
  - Массовые операции (отметить как прочитанные, разрешить)
  - Фильтрация по типу, важности, статусу
  - Цветовая индикация критичности

#### 5. EquipmentCategories.vue - Управление категориями
- **Местоположение**: `src/components/Warehouse/EquipmentCategories.vue`
- **Описание**: Управление категориями оборудования
- **Функции**:
  - CRUD операции с категориями
  - Отображение статистики по категориям
  - Индикация низких остатков
  - Активация/деактивация категорий

### Диалоговые компоненты

#### 1. EquipmentDialog.vue - Создание/редактирование оборудования
- **Функции**:
  - Валидация всех полей
  - Автогенерация QR кодов
  - Поддержка различных типов оборудования
  - Группировка полей по логическим блокам

#### 2. EquipmentViewDialog.vue - Просмотр деталей оборудования
- **Функции**:
  - Детальное отображение всей информации
  - Парсинг и отображение технических характеристик
  - Индикация состояния гарантии
  - История операций с оборудованием

#### 3. EquipmentInstallDialog.vue - Установка оборудования
- **Функции**:
  - Выбор объекта для установки
  - Валидация доступности оборудования
  - Предупреждения о состоянии оборудования

#### 4. EquipmentTransferDialog.vue - Перемещение оборудования
- **Функции**:
  - Выбор нового местоположения
  - Автоматическое исключение текущего местоположения
  - Добавление заметок о причине перемещения

#### 5. QRScanDialog.vue - Сканирование QR кодов
- **Функции**:
  - Ввод QR кода вручную
  - Симуляция сканирования (для демо)
  - Демо QR коды для тестирования
  - Поиск оборудования по QR коду

#### 6. EquipmentCategoryDialog.vue - Создание/редактирование категорий
- **Функции**:
  - Валидация названия и кода категории
  - Автоформатирование кода
  - Предварительный просмотр категории

#### 7. EquipmentCategoryViewDialog.vue - Просмотр категории
- **Функции**:
  - Статистика оборудования в категории
  - Индикатор уровня запасов
  - Предупреждения о низких остатках

### Общие компоненты

#### ConfirmDialog.vue - Диалог подтверждения
- **Местоположение**: `src/components/Common/ConfirmDialog.vue`
- **Функции**:
  - Универсальный диалог подтверждения
  - Различные типы (info, warning, error, success)
  - Настраиваемые тексты и цвета

## Типы данных

### Основные типы (src/types/warehouse.ts)

```typescript
// Статусы оборудования
export type EquipmentStatus = "in_stock" | "reserved" | "installed" | "maintenance" | "broken" | "disposed";

// Состояния оборудования  
export type EquipmentCondition = "new" | "used" | "refurbished" | "damaged";

// Типы складских операций
export type WarehouseOperationType = "receive" | "issue" | "transfer" | "inventory" | "maintenance" | "disposal";

// Типы уведомлений
export type StockAlertType = "low_stock" | "expired_warranty" | "maintenance_due" | "equipment_movement";
```

### Интерфейсы данных

```typescript
// Базовое оборудование
interface EquipmentBase {
  id: number;
  type: string;
  model: string;
  brand: string;
  serial_number: string;
  imei: string;
  phone_number: string;
  mac_address: string;
  qr_code: string;
  status: EquipmentStatus;
  condition: EquipmentCondition;
  // ... другие поля
}

// Категория оборудования
interface EquipmentCategory {
  id: number;
  name: string;
  description: string;
  code: string;
  min_stock_level: number;
  is_active: boolean;
}

// Складская операция
interface WarehouseOperation {
  id: number;
  type: WarehouseOperationType;
  description: string;
  status: WarehouseOperationStatus;
  equipment_id: number;
  from_location: string;
  to_location: string;
  // ... другие поля
}

// Уведомление склада
interface StockAlert {
  id: number;
  type: StockAlertType;
  title: string;
  description: string;
  severity: StockAlertSeverity;
  status: StockAlertStatus;
  // ... другие поля
}
```

## Сервисы

### WarehouseService (src/services/warehouseService.ts)

Основной сервис для работы с API склада:

```typescript
class WarehouseService {
  // Оборудование
  async getEquipment(filters?: EquipmentFilters): Promise<EquipmentResponse>
  async getEquipmentById(id: number): Promise<EquipmentBase>
  async createEquipment(equipment: EquipmentForm): Promise<EquipmentBase>
  async updateEquipment(id: number, equipment: Partial<EquipmentForm>): Promise<EquipmentBase>
  async deleteEquipment(id: number): Promise<void>
  async installEquipment(id: number, data: EquipmentInstallForm): Promise<EquipmentBase>
  async uninstallEquipment(id: number): Promise<EquipmentBase>
  
  // Категории
  async getEquipmentCategories(activeOnly?: boolean): Promise<EquipmentCategory[]>
  async createEquipmentCategory(category: Omit<EquipmentCategory, 'id' | 'created_at' | 'updated_at'>): Promise<EquipmentCategory>
  async updateEquipmentCategory(id: number, category: Partial<EquipmentCategory>): Promise<EquipmentCategory>
  async deleteEquipmentCategory(id: number): Promise<void>
  
  // Операции
  async getWarehouseOperations(filters?: WarehouseOperationFilters): Promise<WarehouseOperationResponse>
  async createWarehouseOperation(operation: WarehouseOperationForm): Promise<WarehouseOperation>
  async transferEquipment(data: EquipmentTransferForm): Promise<WarehouseOperation>
  
  // Уведомления
  async getStockAlerts(filters?: StockAlertFilters): Promise<StockAlertResponse>
  async acknowledgeStockAlert(id: number): Promise<StockAlert>
  async resolveStockAlert(id: number): Promise<StockAlert>
  
  // Статистика
  async getWarehouseStats(): Promise<WarehouseStats>
  async getEquipmentStats(): Promise<EquipmentStats>
  async getLowStockEquipment(threshold?: number): Promise<LowStockItem[]>
  
  // Утилиты
  async searchByQRCode(qrCode: string): Promise<EquipmentBase>
}
```

### Mock данные (src/services/mockWarehouseData.ts)

Демонстрационные данные для разработки и тестирования:

- `mockEquipmentCategories` - 5 категорий оборудования
- `mockEquipment` - 10 единиц различного оборудования
- `mockWarehouseOperations` - 5 складских операций
- `mockStockAlerts` - 4 уведомления различных типов
- `mockWarehouseStats` - статистика склада

## Функциональность

### 1. Каталог оборудования

**Возможности:**
- ✅ Поиск по множественным полям (серийный номер, IMEI, модель, QR код)
- ✅ Фильтрация по статусу, состоянию, категории, типу
- ✅ Переключение между сеткой карточек и таблицей
- ✅ Сортировка по дате, модели, статусу
- ✅ Пагинация результатов
- ✅ Создание и редактирование оборудования
- ✅ Установка/снятие оборудования
- ✅ Перемещение между локациями
- ✅ Удаление оборудования (с проверками)

**Особенности:**
- Debounced поиск для оптимизации производительности
- Цветовая индикация статусов и состояний
- Проверка доступности для операций
- Responsive дизайн для мобильных устройств

### 2. Складские операции

**Типы операций:**
- **Поступление** (receive) - добавление нового оборудования
- **Выдача** (issue) - выдача оборудования для установки
- **Перемещение** (transfer) - перемещение между локациями
- **Инвентаризация** (inventory) - учет и проверка
- **Обслуживание** (maintenance) - отправка на ремонт
- **Списание** (disposal) - вывод из эксплуатации

**Возможности:**
- ✅ Timeline отображение с хронологией
- ✅ Фильтрация по типу, статусу, датам
- ✅ Детальная информация о каждой операции
- ✅ Связь с оборудованием и пользователями
- ✅ Автоматическая генерация номеров документов

### 3. Система уведомлений

**Типы уведомлений:**
- **Низкий остаток** (low_stock) - остаток ниже минимального
- **Истекла гарантия** (expired_warranty) - окончание гарантийного срока
- **Требуется обслуживание** (maintenance_due) - плановое обслуживание
- **Движение оборудования** (equipment_movement) - перемещения

**Уровни важности:**
- **Критический** (critical) - требует немедленного внимания
- **Высокий** (high) - важное уведомление
- **Средний** (medium) - обычное уведомление
- **Низкий** (low) - информационное уведомление

**Возможности:**
- ✅ Сортировка по важности и дате
- ✅ Массовые операции (отметить как прочитанные, разрешить)
- ✅ Фильтрация по всем параметрам
- ✅ Цветовая индикация критичности
- ✅ Связь с конкретным оборудованием или категорией

### 4. Управление категориями

**Возможности:**
- ✅ CRUD операции с категориями
- ✅ Настройка минимальных остатков
- ✅ Активация/деактивация категорий
- ✅ Статистика оборудования по категориям
- ✅ Индикация низких остатков
- ✅ Валидация кодов категорий

## Демо данные

### Категории оборудования
1. **GPS-трекеры** (GPS) - минимум 15 шт.
2. **IP-камеры** (CAM) - минимум 10 шт.
3. **Датчики** (SENS) - минимум 20 шт.
4. **Кабели** (CBL) - минимум 50 шт.
5. **Коммутаторы** (NET) - минимум 5 шт.

### Примеры оборудования
1. **Concox GT06N** - GPS-трекер (в наличии)
2. **Hikvision DS-2CD2043G2-I** - IP-камера 4MP (в наличии)
3. **Teltonika FMB920** - GPS-трекер (установлен)
4. **PIR-Motion-01** - датчик движения (в наличии)
5. **CommScope UTP Cat6** - кабель 305м (в наличии)
6. **TP-Link TL-SG1008D** - коммутатор (зарезервирован)
7. **Concox GT06N** - GPS-трекер (на обслуживании)
8. **Hikvision DS-2CD2043G2-I** - IP-камера (сломана)

### Складские операции
- Поступление нового оборудования
- Выдача для монтажа
- Перемещение между полками
- Плановое обслуживание
- Инвентаризация

### Уведомления
- Низкий остаток IP-камер (высокая важность)
- Истекла гарантия на GPS-трекер (средняя важность)
- Требуется обслуживание камеры (низкая важность)
- Критически низкий остаток кабелей (критическая важность)

## Технические особенности

### 1. Архитектура
- **Composition API** для всех компонентов
- **TypeScript** для типизации
- **Pinia** для управления состоянием (если потребуется)
- **Vuetify 3** для UI компонентов

### 2. Производительность
- Debounced поиск (300ms задержка)
- Пагинация для больших списков
- Ленивая загрузка данных
- Кэширование часто используемых данных

### 3. UX/UI
- **Apple Design System** интеграция
- Responsive дизайн для всех экранов
- Цветовая индикация статусов
- Анимации и переходы
- Accessibility поддержка

### 4. Валидация
- Валидация IMEI (15 цифр)
- Валидация телефонных номеров (+7XXXXXXXXXX)
- Валидация MAC адресов (XX:XX:XX:XX:XX:XX)
- Валидация JSON для технических характеристик
- Проверка уникальности серийных номеров

### 5. Безопасность
- Проверка прав доступа для всех операций
- Валидация на клиенте и сервере
- Защита от XSS и CSRF
- Мультитенантность

## Интеграции

### 1. С существующими модулями
- **Объекты** - установка оборудования на объекты
- **Монтажи** - автоматическая выдача оборудования
- **Пользователи** - отслеживание ответственных лиц
- **Уведомления** - интеграция с общей системой уведомлений

### 2. С внешними системами
- **Axetna.cloud** - синхронизация данных оборудования
- **1C** - экспорт данных о закупках
- **Bitrix24** - синхронизация с CRM

## Тестирование

### 1. Компонентные тесты
- Тестирование отображения данных
- Проверка фильтрации и поиска
- Валидация форм
- Обработка ошибок

### 2. E2E тесты (планируется)
- Полный цикл работы со складом
- Создание оборудования и операций
- Проверка уведомлений
- Интеграция с другими модулями

## Развертывание

### 1. Зависимости
```json
{
  "vue": "^3.5.18",
  "vuetify": "^3.9.4",
  "typescript": "~5.8.3",
  "lodash-es": "^4.17.21",
  "@types/lodash-es": "^4.17.12"
}
```

### 2. Сборка
```bash
npm run build
```

### 3. Разработка
```bash
npm run dev
```

## Roadmap

### Ближайшие улучшения
- [ ] E2E тесты для всех сценариев
- [ ] Интеграция с реальным сканером QR кодов
- [ ] Экспорт данных в Excel/PDF
- [ ] Мобильное приложение для складских операций
- [ ] Интеграция с системой штрихкодирования

### Долгосрочные планы
- [ ] AI-powered предсказание потребностей в оборудовании
- [ ] Интеграция с IoT датчиками склада
- [ ] Автоматическое планирование закупок
- [ ] Система автоматической инвентаризации

## Заключение

Интерфейс управления складом представляет собой современное, полнофункциональное решение для управления оборудованием компании. Система обеспечивает полный контроль над складскими процессами, автоматизирует рутинные операции и предоставляет детальную аналитику для принятия управленческих решений.

Все компоненты построены с учетом лучших практик Vue 3 и современных стандартов разработки, обеспечивая высокую производительность, безопасность и удобство использования.
